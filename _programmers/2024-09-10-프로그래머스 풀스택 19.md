---
layout: post
title:  "í”„ë¡œê·¸ë˜ë¨¸ìŠ¤ í’€ìŠ¤íƒ 19"
excerpt: "í’€ìŠ¤íƒ19"
category: programmers
tags: [programmers]
date: '2024-09-10 15:00:00 +09:00'
last_modified_at: '2024-09-10'
---

# í”„ë¡œê·¸ë˜ë¨¸ìŠ¤ í’€ìŠ¤íƒ 19
ë°±ì—”ë“œ ê¸°ì´ˆ: Node.js + Express ê¸°ë³¸(10)

## ğŸŒŠ router

**ğŸ’« Serverì™€ Routerì˜ ì—­í• **<br>
- Server : Requestë¥¼ ë°›ìŒ<br>
- Router : Requestì˜ URLì— ë”°ë¼ ë£¨íŠ¸(route)ë¥¼ ì •í•´ì¤Œ => ì–´ë””ë¡œ ê°ˆì§€ ê¸¸ì„ ì •í•´ì¤Œ!<br>
- .routeë¡œ ë¶„ë¥˜í•˜ëŠ” ê±´ expressë§Œì˜ ì¥ì !<br>

<br>

**ğŸ’«"Node.jsì—ì„œì˜" ë¼ìš°íŒ…ì´ë€?**<br>

- Request(ìš”ì²­)ê°€ ë‚ ì•„ì™”ì„ ë•Œ, ì›í•˜ëŠ” ê²½ë¡œì— ë”°ë¼ ì ì ˆí•œ ë°©í–¥ìœ¼ë¡œ ê²½ë¡œë¥¼ ì•ˆë‚´í•´ì£¼ëŠ” ê²ƒ<br>
- URL, Method => í˜¸ì¶œ "ì½œë°± í•¨ìˆ˜"<br>

<br>

**ğŸ’« user-demo ì—°ê²° ì‹¤ìŠµ!**<br>
```javascript
router.use(express.json()) 
```
- app.jsì—ì„œ appì„ ë‹¤ ê°€ì ¸ê°”ìœ¼ë¯€ë¡œ app -> routerë¡œ ëŒ€ì²´!<br>
- use: http ì™¸ ëª¨ë“ˆ 'json'. bodyì—ì„œ êº¼ë‚´ì„œ jsonì²˜ëŸ¼ ì“¸ê±°ì•¼!(ë¯¸ë“¤ì›¨ì–´ ì„¤ì •)<br>
<br>

![alt text](img01/image-176.png)<br>
![alt text](img01/image-177.png)<br>
- ì˜ ì‘ë™í•˜ëŠ” ê±¸ í™•ì¸!<br><br/>

## rename, channel-demo ì—°ê²°, ëª¨ë“ˆ ì´ë¦„ ë³€ê²½, use URL ì„¤ëª…

**ğŸ’« Refactoring**<br>
- ë¦¬íŒ©í† ë§ ìì²´ëŠ” Ctrl + Shift + R!<br>
- í•œë²ˆì— ì´ë¦„ì„ ë°”ê¾¸ë ¤ë©´ ë¸”ë¡ì„ ì¡ì€ ë’¤ **Rename symbol(F2ë²ˆ)** í•´ì£¼ë©´ ë¨!<br>

<br>

**ğŸ’« channel-demo ì—°ê²° ì‹¤ìŠµ!**<br>
![alt text](img01/image-178.png)<br>

<br>

**ğŸ’« ëª¨ë“ˆ ì´ë¦„ ë³€ê²½**<br>

- user-demo -> users<br>
- channel-demo -> channels<br>

<br>

**ğŸ’« use URL ì„¤ëª…**<br>

ğŸ’« \<app.jsíŒŒì¼><br>
```javascript
app.use("/", userRouter)
app.use("/channels", channelRouter) 
```
<br>

ğŸ’« \<channels.js íŒŒì¼><br>
```javascript
router
    .route('/') 
//...ìƒëµ
router
    .route('/:id')
```
- app.jsì—ì„œ app.use("/channels", channelRouter)ë¡œ ë¹¼ì¤¬ê¸°ì— channels.jsì—ì„œ route ì¤‘ë³µì œê±°<br><br/>

## ğŸŒŠ íšŒì›ë§ˆë‹¤ ì±„ë„ ê°€ì§€ê²Œ ERD ê·¸ë ¤ë³´ê¸°

**ğŸ’« íšŒì›ë§ˆë‹¤ ì±„ë„ ê°€ì§€ê²Œ ERD ê·¸ë ¤ë³´ê¸°**<br>

![alt text](img01/image-179.png)<br>
![alt text](img01/image-180.png)<br>

ì±„ë„<br>
- ì–´ë–¤ íšŒì›ì´ ë§Œë“  ì±„ë„ì¸ì§€ ì²´í¬í•  ìˆ˜ ìˆìœ¼ë©´ ì¢‹ê² ìŒ!<br>
- ì±„ë„ í•˜ë‚˜ì˜ rowë¥¼ ê°€ì§€ê³  ì–´ë–¤ íšŒì›ì´ ê°€ì§€ê³  ìˆëŠ”ì§€ ë¿ë§Œ ì•„ë‹ˆë¼ idë¥¼ ì°¾ì•„ê°€ë©° ì´ë¦„, ë¹„ë°€ë²ˆí˜¸ê¹Œì§€ í™•ì¸ ê°€ëŠ¥<br>
- ì±„ë„ -> íšŒì›ì— ëŒ€í•œ ì •ë³´ì— ì ‘ê·¼ ê°€ëŠ¥<br><br/>

## ğŸŒŠ ì±„ë„ API ì„¤ê³„ ìˆ˜ì •, ì±„ë„ ìƒì„± í…ŒìŠ¤íŠ¸


**ğŸ’« ì±„ë„ API ì„¤ê³„ ìˆ˜ì •**<br>

**ì±„ë„**<br>
1. ì±„ë„ "ìƒì„±" : POST /channels<br>
getê³¼ postì˜ ê°€ì¥ í° ì°¨ì´ : bodyì˜ ìœ ë¬´!!(body ìˆìœ¼ë©´ post!!)
    - req : body(channelTitle, <span style="color:lightseagreen">**userId**</span>) *cf. userIdëŠ” body X header ìˆ¨ê²¨ì„œ Token*<br>
    - **res 201 : \`${channelTitle}ë‹˜ ì±„ë„ ìƒì„±ì„ ì¶•í•˜ë“œë¦½ë‹ˆë‹¤!`** ğŸ‘‰ ë‹¤ë¥¸ í˜ì´ì§€ ë„ì›Œì£¼ê³  ì‹¶ìŒ.. ex ì±„ë„ ê´€ë¦¬ í˜ì´ì§€<br>

2. ì±„ë„ "ìˆ˜ì •" : PUT /channels/:id<br>
    - req : URL(id), body(channelTitle)<br>
    - **res 200 : \`ì±„ë„ëª…ì´ ì„±ê³µì ìœ¼ë¡œ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤! ê¸°ì¡´ : ${channelTitle} -> ìˆ˜ì • : ${channelTitle}`**<br>

3. ì±„ë„ ê°œë³„ "ì‚­ì œ" : DELETE /channels/:id<br>
    - req : URL(id)<br>
    - **res 200 : \`${channelTitle}ì´ ì •ìƒì ìœ¼ë¡œ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤. ì•„ì‰½ì§€ë§Œ ë‹¤ìŒì— ëµ™ê² ìŠµë‹ˆë‹¤!`** ğŸ‘‰ ë©”ì¸ í˜ì´ì§€<br>

4. íšŒì›ì˜ ì±„ë„ ì „ì²´ "ì¡°íšŒ" : GET /channels<br>
    - req : <span style="color:lightseagreen">**body(userId)**</span><br>
    - **res 200 : ì±„ë„ ì „ì²´ ë°ì´í„° list, json array**<br>

5. ì±„ë„ ê°œë³„ "ì¡°íšŒ" : GET /channels/:id<br>
    - req : URL(id)<br>
    - **res 200 : ì±„ë„ ê°œë³„ ë°ì´í„°**<br><br/>

**ğŸ’« ì±„ë„ ìƒì„± í…ŒìŠ¤íŠ¸**<br>
```javascript
    .post((req, res) => {
        // const {channelTitle} = req.body
        if (req.body.channelTitle) {
            let channel = req.body
            db.set(id++, channel)
            
            res.status(201).json({
                message : `${db.get(id-1).channelTitle}ë‹˜ ì±„ë„ ìƒì„±ì„ ì¶•í•˜ë“œë¦½ë‹ˆë‹¤!`
            })
        } else {
            res.status(400).json({
                message : "ì£„ì†¡í•©ë‹ˆë‹¤. ìš”ì²­ ê°’ì„ ë‹¤ì‹œ ë³´ë‚´ì£¼ì„¸ìš”."
            })
        }
    })
```
![alt text](img01/image-181.png)<br>
- let channel = req.body, db.set(id++, channel)ê°€ ë³€ê²½ëœ ê²ƒ!<br>
- ë°ì´í„°ë² ì´ìŠ¤ê°€ ì•„ë‹ˆë¼ì„œ testIdê°€ ìˆëŠ”ì§€ ì•„ë‹Œì§€ íŒë‹¨ì„ í•´ì•¼í•¨!<br><br/>

## ğŸŒŠ íšŒì› ì±„ë„ ì¡°íšŒ, idì—†ìœ¼ë©´ ì˜ˆì™¸ ì²˜ë¦¬

**ğŸ’« íšŒì› ì±„ë„ ì¡°íšŒ**<br>

- forEachë¥¼ ëŒë¦¬ëŠ” ë™ì•ˆ value ê°’ì´ idê°’ì´ ë§ëŠ”ì§€ í™•ì¸!<br>

**ğŸ’« idì—†ìœ¼ë©´ ì˜ˆì™¸ ì²˜ë¦¬**<br>

- íšŒì› ì±„ë„ ì „ì²´ ì¡°íšŒì‹œ body ê°’ì— userId ê°’ì´ ì—†ìœ¼ë©´ ì˜ˆì™¸ì²˜ë¦¬!(userIdê°€ bodyì— ì—†ì„ ë•Œ)<br>
- body ê°’ì— userId ê°’ì´ ì±„ë„ì´ ìƒì„±ëœ ê°’ì´ ì•„ë‹ ë•Œë„ ì˜ˆì™¸ì²˜ë¦¬!(userIdë¥¼ ê°€ì§„ ì±„ë„ì´ ì—†ì„ ë•Œ)<br>

![alt text](img01/image-182.png)<br>
```javascript
if (userId == undefined) {// ì˜ˆì™¸ ì²˜ë¦¬ 2ê°€ì§€ 1) userIdê°€ bodyì— ì—†ì„ ë•Œ
    res.status(404).json({
         message : "ë¡œê·¸ì¸ì´ í•„ìš”í•œ í˜ì´ì§€ì…ë‹ˆë‹¤."
    })
```
- ê³ ë„í™”ê°€ í•„ìš”í•œ ëª¨ìŠµ!(ifë¬¸ ì¤‘ì²©ì´ ë„ˆë¬´ ë§ì´ë¨)<br><br/>

## ğŸŒŠ idì—†ìœ¼ë©´ ì˜ˆì™¸ ì²˜ë¦¬ ifë¬¸ ê³ ë„í™”

**ğŸ’« ifë¬¸ ì¤‘ì²© í•´ê²°ë²•**<br>

- ë…¼ë¦¬ ì—°ì‚°ìë¡œ ë¬¶ê¸°<br>
- includes() í•¨ìˆ˜ë¡œ ì¡°ê±´ì„ ë°°ì—´ì— ë„£ì–´ ì²˜ë¦¬í•˜ê¸°<br>
- **ë¹„êµ¬ì¡°í™” ê³ ë ¤!(ì œì¼ ì¶”ì²œ)**<br>

```javascript
    .get((req, res) => {
        var {userId} = req.body
        var channels = [] // {}í˜•íƒœê°€ ì•„ë‹ˆë¼ [] listë¡œ ë°”ê¾¸ê¸°
        if(db.size && userId) { // ì˜ˆì™¸ ì²˜ë¦¬ 2ê°€ì§€ 1) userIdê°€ bodyì— ì—†ì„ ë•Œ
                db.forEach(function(value, key) {
                    if (value.userId === userId) //valueì˜ userId === userId
                        channels.push(value)
                })
                    // 2) userIdë¥¼ ê°€ì§„ ì±„ë„ì´ ì—†ì„ ë•Œ
                if (channels.length) {
                    res.status(200).json(channels)
                } else {
                    notFoundChannel()
                }
            } else {
                notFoundChannel()
        }
    }) // ì±„ë„ ì „ì²´ ì¡°íšŒ
    //...ìƒëµ
    function notFoundChannel() {
    res.status(404).json({
        message : "ì£„ì†¡í•©ë‹ˆë‹¤. ì±„ë„ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."
    })
} 
```
- ifë¬¸ ê³ ë„í™” í•œ ëª¨ìŠµ!<br><br/>

## ğŸŒŠ ë°±ì—”ë“œ ê¸°ì´ˆ ë§ˆë¬´ë¦¬

**íšŒì›**<br>
1. ë¡œê·¸ì¸ : POST /login<br>
getê³¼ postì˜ ê°€ì¥ í° ì°¨ì´ : bodyì˜ ìœ ë¬´!!(body ìˆìœ¼ë©´ post!!)
    - req : body(id, pwd)<br>
    - **res : \`${name}ë‹˜ í™˜ì˜í•©ë‹ˆë‹¤!`** //ğŸ‘‰ ë©”ì¸ í˜ì´ì§€ ì¶œë ¥<br>

2. íšŒì› ê°€ì… : POST /join<br>
    - req : body(id, pwd, name)<br>
    - **res : \`${name}ë‹˜ íšŒì› ê°€ì…ì„ ì¶•í•˜ë“œë¦½ë‹ˆë‹¤!`** //ğŸ‘‰ ë¡œê·¸ì¸ í˜ì´ì§€<br>

3. íšŒì› ê°œë³„ "ì¡°íšŒ" : GET /users/:id<br>
    - req : <span style="color:lightseagreen">**body(userId)**</span><br>
    - res : userId, name<br>

4. íšŒì› ê°œë³„ íƒˆí‡´ : DELETE /users/:id<br>
    - req : <span style="color:lightseagreen">**body(userId)**</span><br>
    - **res : \`${name}ë‹˜ ì•„ì‰½ì§€ë§Œ, ë‹¤ìŒì— ë˜ ëµ™ê² ìŠµë‹ˆë‹¤!`** or ë©”ì¸ í˜ì´ì§€ ì¶œë ¥<br>

<br>

ğŸ’« \<ì‹¤ìŠµ><br>
![alt text](img01/image-183.png)<br>
- users.jsë¥¼ ê³ ë„í™”í•˜ì—¬ ì‹¤í–‰í•œ ëª¨ìŠµ!<br><br/>

## ğŸŒŠ ëŠë‚€ ì (YWT)

**Y ì¼ì„ í†µí•´ ëª…í™•íˆ ì•Œê²Œ ë˜ì—ˆê±°ë‚˜ ì´í•´í•œ ë¶€ë¶„(í•œ ì¼)ì— ëŒ€í•´ ì •ë¦¬ :**<br>
.routeë¡œ ë¶„ë¥˜í•˜ëŠ” ê±´ expressë§Œì˜ ì¥ì !, Node.jsì—ì„œì˜ ë¼ìš°íŒ…ì´ë€?<br>

**W ë°°ìš´ ì ê³¼ ì‹œì‚¬ì  :**<br>

**ğŸ’« Serverì™€ Routerì˜ ì—­í• **<br>
- Server : Requestë¥¼ ë°›ìŒ<br>
- Router : Requestì˜ URLì— ë”°ë¼ ë£¨íŠ¸(route)ë¥¼ ì •í•´ì¤Œ => ì–´ë””ë¡œ ê°ˆì§€ ê¸¸ì„ ì •í•´ì¤Œ!<br>
- .routeë¡œ ë¶„ë¥˜í•˜ëŠ” ê±´ expressë§Œì˜ ì¥ì !<br>

**ğŸ’«"Node.jsì—ì„œì˜" ë¼ìš°íŒ…ì´ë€?**<br>

- Request(ìš”ì²­)ê°€ ë‚ ì•„ì™”ì„ ë•Œ, ì›í•˜ëŠ” ê²½ë¡œì— ë”°ë¼ ì ì ˆí•œ ë°©í–¥ìœ¼ë¡œ ê²½ë¡œë¥¼ ì•ˆë‚´í•´ì£¼ëŠ” ê²ƒ<br>
- URL, Method => í˜¸ì¶œ "ì½œë°± í•¨ìˆ˜"<br>
  
**T ì‘ìš©í•˜ì—¬ ë°°ìš´ ê²ƒì„ ì–´ë””ì— ì–´ë–»ê²Œ ì ìš©í• ì§€:**<br>
ë°±ì—”ë“œ ê¸°ì´ˆê³¼ì •ì´ ëë‚¬ëŠ”ë° ì‘ì€ í”„ë¡œì íŠ¸ë¥¼ í•˜ë‚˜ ì§„í–‰í•´ë³´ëŠ” ê²Œ ì‰½ê³  ë¹ ë¥´ê²Œ ë³µìŠµí•  ìˆ˜ë„ ìˆê³  ëŠ¥ë ¥ì„ ë°œì „ì‹œí‚¬ ìˆ˜ ìˆì„ ê²ƒì´ë‹¤!<br>


